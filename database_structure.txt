C:\Users\williamm\Desktop\datos\inspect_database.py:162: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df_sample = pd.read_sql(f"SELECT * FROM {table_name} LIMIT 3", conn)
================================================================================
INSPECCIÓN DE BASE DE DATOS - test_nps
================================================================================

[TABLAS EN LA BASE DE DATOS]
--------------------------------------------------------------------------------

================================================================================
TABLA: banco_movil_clean
================================================================================

[COLUMNAS]
--------------------------------------------------------------------------------
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| Columna                  | Tipo                        | Nullable   | Default                                       |
+==========================+=============================+============+===============================================+
| id                       | integer                     | NOT NULL   | nextval('banco_movil_clean_id_seq'::regclass) |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| timestamp                | timestamp without time zone | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| answer_date              | timestamp without time zone | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| answers                  | text                        | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| channel                  | character varying(50)       | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| cust_ident_num           | bigint                      | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| cust_ident_type          | character varying(10)       | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| feedback_type            | character varying(50)       | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| record_id                | integer                     | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| nps_original             | character varying(50)       | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| nps_recomendacion_score  | double precision            | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| nps_recomendacion_motivo | text                        | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| csat_satisfaccion_score  | double precision            | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| csat_satisfaccion_motivo | text                        | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| nps_score                | double precision            | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| nps_category             | character varying(20)       | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| cleaned_date             | timestamp without time zone | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| file_type                | character varying(10)       | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| month_year               | character varying(20)       | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| source_file              | character varying(255)      | NULL       | -                                             |
+--------------------------+-----------------------------+------------+-----------------------------------------------+
| inserted_at              | timestamp without time zone | NULL       | now()                                         |
+--------------------------+-----------------------------+------------+-----------------------------------------------+

[CONSTRAINTS]
--------------------------------------------------------------------------------
+------------------------+-------------+--------------+
| Constraint             | Tipo        | Columna(s)   |
+========================+=============+==============+
| banco_movil_clean_pkey | PRIMARY KEY | id           |
+------------------------+-------------+--------------+

[INDICES]
--------------------------------------------------------------------------------
  • banco_movil_clean_pkey
    btree (id)
  • idx_bm_category
    btree (nps_category)
  • idx_bm_month
    btree (month_year)
  • idx_bm_nps_score
    btree (nps_score)

[ESTADISTICAS]
--------------------------------------------------------------------------------
  Registros: 1,234,628
  Tamaño: 704 MB

[MUESTRA DE DATOS - primeras 3 filas]
--------------------------------------------------------------------------------
Mostrando primeras 8 de 21 columnas
 id           timestamp             answer_date                        answers channel  cust_ident_num cust_ident_type feedback_type
  1 2025-07-31 19:00:02 2025-08-01 00:00:00.729 [{'questionTitle': 'Teniend...      BM        52857592              CC           NPS
  2 2025-07-31 19:00:12 2025-08-01 00:00:10.133 [{'questionTitle': 'Teniend...      BM        72357816              CC           NPS
  3 2025-07-31 19:00:11 2025-08-01 00:00:04.038 [{'questionTitle': 'Teniend...      BM      1003915296              CC           NPS
... y 13 columnas más

[ARCHIVOS PROCESADOS - ultimos 5]
--------------------------------------------------------------------------------
+--------------------------------------------------+-------------+----------------------------+
| Archivo                                          | Registros   | Última Inserción           |
+==================================================+=============+============================+
| agosto_bm_2025_muestra_281230_LIMPIO.xlsx        | 281,230     | 2025-10-06 13:46:01.782779 |
+--------------------------------------------------+-------------+----------------------------+
| 1 Base Junio_BM_2025_muestra_195455_LIMPIO.xlsx  | 390,910     | 2025-10-06 13:44:26.082457 |
+--------------------------------------------------+-------------+----------------------------+
| 1 Base Julio_BM_2025_muestra_14_LIMPIO.xlsx      | 28          | 2025-10-06 13:43:53.355683 |
+--------------------------------------------------+-------------+----------------------------+
| 1 Base Agosto_BM_2025_muestra_281230_LIMPIO.xlsx | 562,460     | 2025-10-06 13:42:40.370959 |
+--------------------------------------------------+-------------+----------------------------+C:\Users\williamm\Desktop\datos\inspect_database.py:162: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df_sample = pd.read_sql(f"SELECT * FROM {table_name} LIMIT 3", conn)


================================================================================
TABLA: banco_virtual_clean
================================================================================

[COLUMNAS]
--------------------------------------------------------------------------------
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| Columna                 | Tipo                        | Nullable   | Default                                         |
+=========================+=============================+============+=================================================+
| id                      | integer                     | NOT NULL   | nextval('banco_virtual_clean_id_seq'::regclass) |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| date_submitted_original | character varying(50)       | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| date_submitted          | timestamp without time zone | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| country                 | character varying(100)      | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| source_url              | text                        | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| device                  | character varying(100)      | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| browser                 | character varying(200)      | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| operating_system        | character varying(200)      | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| nps_score_bv            | integer                     | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| calificacion_acerca     | text                        | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| motivo_calificacion     | text                        | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| tags_recomendacion      | text                        | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| tags_calificacion       | text                        | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| tags_motivo             | text                        | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| sentiment_motivo        | text                        | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| month_year              | character varying(20)       | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| nps_score               | integer                     | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| nps_category            | character varying(20)       | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| cleaned_date            | timestamp without time zone | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| file_type               | character varying(10)       | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| source_file             | character varying(255)      | NULL       | -                                               |
+-------------------------+-----------------------------+------------+-------------------------------------------------+
| inserted_at             | timestamp without time zone | NULL       | now()                                           |
+-------------------------+-----------------------------+------------+-------------------------------------------------+

[CONSTRAINTS]
--------------------------------------------------------------------------------
+--------------------------+-------------+--------------+
| Constraint               | Tipo        | Columna(s)   |
+==========================+=============+==============+
| banco_virtual_clean_pkey | PRIMARY KEY | id           |
+--------------------------+-------------+--------------+

[INDICES]
--------------------------------------------------------------------------------
  • banco_virtual_clean_pkey
    btree (id)
  • idx_bv_country
    btree (country)
  • idx_bv_device
    btree (device)
  • idx_bv_nps_score
    btree (nps_score)

[ESTADISTICAS]
--------------------------------------------------------------------------------
  Registros: 5,727
  Tamaño: 2072 kB

[MUESTRA DE DATOS - primeras 3 filas]
--------------------------------------------------------------------------------
Mostrando primeras 8 de 22 columnas
 id date_submitted_original      date_submitted  country                     source_url  device        browser operating_system
  1     2025-08-29 20:37:34 2025-08-29 20:37:34 Colombia https://virtual.bancodebogo... desktop Chrome 139.0.0       Windows 10
  2     2025-08-29 20:36:42 2025-08-29 20:36:42 Colombia https://virtual.bancodebogo... desktop Chrome 139.0.0       Windows 10
  3     2025-08-29 20:36:04 2025-08-29 20:36:04 Colombia https://virtual.bancodebogo... desktop   Edge 139.0.0       Windows 10
... y 14 columnas más

[ARCHIVOS PROCESADOS - ultimos 5]
--------------------------------------------------------------------------------
+------------------------------------------------+-------------+----------------------------+
| Archivo                                        | Registros   | Última Inserción           |
+================================================+=============+============================+
| agosto_bv_2025_muestra_1904_LIMPIO.xlsx        | 1,904       | 2025-10-06 13:47:17.696331 |
+------------------------------------------------+-------------+----------------------------+
| 1 Base Junio_BV_2025_muestra_1891_LIMPIO.xlsx  | 1,891       | 2025-10-06 13:47:16.902056 |
+------------------------------------------------+-------------+----------------------------+
| 1 Base Junio_BV_2025_muestra_14_LIMPIO.xlsx    | 14          | 2025-10-06 13:47:16.574783 |
+------------------------------------------------+-------------+----------------------------+
| 1 Base julio_BV_2025_muestra_14_LIMPIO.xlsx    | 14          | 2025-10-06 13:47:16.554816 |
+------------------------------------------------+-------------+----------------------------+
| 1 Base Agosto_BV_2025_muestra_1904_LIMPIO.xlsx | 1,904       | 2025-10-06 13:47:16.009091 |
+------------------------------------------------+-------------+----------------------------+C:\Users\williamm\Desktop\datos\inspect_database.py:162: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df_sample = pd.read_sql(f"SELECT * FROM {table_name} LIMIT 3", conn)


================================================================================
TABLA: bm_sample_clean
================================================================================

[COLUMNAS]
--------------------------------------------------------------------------------
+--------------------------+-----------------------------+------------+-----------+
| Columna                  | Tipo                        | Nullable   | Default   |
+==========================+=============================+============+===========+
| timestamp                | timestamp without time zone | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| answerDate               | timestamp without time zone | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| answers                  | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| channel                  | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| custIdentNum             | bigint                      | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| custIdentType            | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| feedbackType             | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| id                       | bigint                      | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| NPS                      | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| nps_recomendacion_score  | double precision            | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| nps_recomendacion_motivo | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| csat_satisfaccion_score  | double precision            | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| csat_satisfaccion_motivo | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| nps_score                | double precision            | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| nps_category             | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| cleaned_date             | timestamp without time zone | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| file_type                | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+
| month_year               | text                        | NULL       | -         |
+--------------------------+-----------------------------+------------+-----------+

[ESTADISTICAS]
--------------------------------------------------------------------------------
  Registros: 39
  Tamaño: 56 kB

[MUESTRA DE DATOS - primeras 3 filas]
--------------------------------------------------------------------------------
Mostrando primeras 8 de 18 columnas
          timestamp              answerDate                        answers channel  custIdentNum custIdentType feedbackType  id
2025-07-31 19:00:02 2025-08-01 00:00:00.729 [{'questionTitle': 'Teniend...      BM      52857592            CC          NPS   1
2025-07-31 19:00:12 2025-08-01 00:00:10.133 [{'questionTitle': 'Teniend...      BM      72357816            CC          NPS   1
2025-07-31 19:00:11 2025-08-01 00:00:04.038 [{'questionTitle': 'Teniend...      BM    1003915296            CC          NPS   1
... y 10 columnas más

================================================================================
TABLA: bv_sample_clean
================================================================================

[COLUMNAS]
--------------------------------------------------------------------------------
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| Columna                                                       | Tipo                        | Nullable   | Default   |
+===============================================================+=============================+============+===========+
| date_submitted_original                                       | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| country                                                       | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| source_url                                                    | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| device                                                        | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| browser                                                       | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| operating_system                                              | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| nps_score_bv                                                  | bigint                      | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| Tu calificación fue acerca de:                                | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| Cuéntanos el motivo de tu calificación:                       | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| Tags for: ¿Qué tan probable es que recomiendes este sitio web | double precision            | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| Tags for: Tu calificación fue acerca de:                      | double precision            | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| Tags for: Cuéntanos el motivo de tu calificación:             | double precision            | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| Sentiment for: Cuéntanos el motivo de tu calificación:        | double precision            | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| date_submitted                                                | timestamp without time zone | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| month_year                                                    | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| nps_score                                                     | bigint                      | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| nps_category                                                  | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| cleaned_date                                                  | timestamp without time zone | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+
| file_type                                                     | text                        | NULL       | -         |
+---------------------------------------------------------------+-----------------------------+------------+-----------+C:\Users\williamm\Desktop\datos\inspect_database.py:162: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df_sample = pd.read_sql(f"SELECT * FROM {table_name} LIMIT 3", conn)
C:\Users\williamm\Desktop\datos\inspect_database.py:162: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df_sample = pd.read_sql(f"SELECT * FROM {table_name} LIMIT 3", conn)
C:\Users\williamm\Desktop\datos\inspect_database.py:162: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df_sample = pd.read_sql(f"SELECT * FROM {table_name} LIMIT 3", conn)


[ESTADISTICAS]
--------------------------------------------------------------------------------
  Registros: 39
  Tamaño: 48 kB

[MUESTRA DE DATOS - primeras 3 filas]
--------------------------------------------------------------------------------
Mostrando primeras 8 de 19 columnas
date_submitted_original  country                     source_url  device        browser operating_system  nps_score_bv Tu calificación fue acerca de:
    2025-08-29 20:37:34 Colombia https://virtual.bancodebogo... desktop Chrome 139.0.0       Windows 10            10                           None
    2025-08-29 20:36:42 Colombia https://virtual.bancodebogo... desktop Chrome 139.0.0       Windows 10            10                           None
    2025-08-29 20:36:04 Colombia https://virtual.bancodebogo... desktop   Edge 139.0.0       Windows 10            10                           None
... y 11 columnas más

================================================================================
TABLA: hello_nps
================================================================================

[COLUMNAS]
--------------------------------------------------------------------------------
+-----------+-----------------------------+------------+---------------------------------------+
| Columna   | Tipo                        | Nullable   | Default                               |
+===========+=============================+============+=======================================+
| id        | integer                     | NOT NULL   | nextval('hello_nps_id_seq'::regclass) |
+-----------+-----------------------------+------------+---------------------------------------+
| mensaje   | text                        | NULL       | -                                     |
+-----------+-----------------------------+------------+---------------------------------------+
| nps_score | integer                     | NULL       | -                                     |
+-----------+-----------------------------+------------+---------------------------------------+
| fecha     | timestamp without time zone | NULL       | now()                                 |
+-----------+-----------------------------+------------+---------------------------------------+

[CONSTRAINTS]
--------------------------------------------------------------------------------
+----------------+-------------+--------------+
| Constraint     | Tipo        | Columna(s)   |
+================+=============+==============+
| hello_nps_pkey | PRIMARY KEY | id           |
+----------------+-------------+--------------+

[INDICES]
--------------------------------------------------------------------------------
  • hello_nps_pkey
    btree (id)

[ESTADISTICAS]
--------------------------------------------------------------------------------
  Registros: 3
  Tamaño: 32 kB

[MUESTRA DE DATOS - primeras 3 filas]
--------------------------------------------------------------------------------
 id            mensaje  nps_score                      fecha
  1 Primera prueba NPS          9 2025-09-18 22:24:33.324034
  2 Segunda prueba NPS          7 2025-09-18 22:24:33.324034
  3 Tercera prueba NPS         10 2025-09-18 22:24:33.324034

================================================================================
TABLA: test_nps_data
================================================================================

[COLUMNAS]
--------------------------------------------------------------------------------
+-------------+-----------------------------+------------+-----------+
| Columna     | Tipo                        | Nullable   | Default   |
+=============+=============================+============+===========+
| timestamp   | timestamp without time zone | NULL       | -         |
+-------------+-----------------------------+------------+-----------+
| customer_id | text                        | NULL       | -         |
+-------------+-----------------------------+------------+-----------+
| nps_score   | bigint                      | NULL       | -         |
+-------------+-----------------------------+------------+-----------+
| channel     | text                        | NULL       | -         |
+-------------+-----------------------------+------------+-----------+
| q1_title    | text                        | NULL       | -         |
+-------------+-----------------------------+------------+-----------+
| q1_value    | bigint                      | NULL       | -         |
+-------------+-----------------------------+------------+-----------+
| month_year  | text                        | NULL       | -         |
+-------------+-----------------------------+------------+-----------+

[ESTADISTICAS]
--------------------------------------------------------------------------------
  Registros: 3
  Tamaño: 16 kB

[MUESTRA DE DATOS - primeras 3 filas]
--------------------------------------------------------------------------------
                 timestamp customer_id  nps_score channel               q1_title  q1_value month_year
2025-09-18 22:29:03.792442     CUST001          9  mobile   ¿Recomiendas la app?         9    2024-08
2025-09-18 22:29:03.792445     CUST002          7  mobile   ¿Recomiendas la app?         7    2024-08
2025-09-18 22:29:03.792446     CUST003         10     web ¿Recomiendas el sitio?        10    2024-08

================================================================================
[RESUMEN GENERAL]
================================================================================
Schema: public
Total de tablas: 6
Tamaño total: 706 MB

[OK] Inspeccion completada
