
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Métricas NPS/CSAT - Análisis Completo por Canal</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            text-align: center;
            padding: 20px;
            background-color: #2c3e50;
            color: white;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .header h1 {
            margin: 0;
            font-size: 28px;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 14px;
            opacity: 0.9;
        }
        .section-title {
            text-align: center;
            background-color: #34495e;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 30px 0 15px 0;
            font-size: 20px;
            font-weight: bold;
        }
        .table-container {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow-x: auto;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        th {
            background-color: #34495e;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            border: 1px solid #2c3e50;
        }
        td {
            padding: 10px 8px;
            text-align: center;
            border: 1px solid #ddd;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tr:hover {
            background-color: #f0f0f0;
        }
        .total-row {
            background-color: #3498db !important;
            color: white;
            font-weight: bold;
        }
        .total-row td {
            border-color: #2980b9;
        }
        .month-col {
            background-color: #ecf0f1;
            font-weight: 600;
            text-align: left;
            padding-left: 15px;
        }
        .number {
            text-align: right;
            padding-right: 15px;
        }
        .detractor {
            color: #e74c3c;
            font-weight: 500;
        }
        .neutral {
            color: #f39c12;
            font-weight: 500;
        }
        .promoter {
            color: #27ae60;
            font-weight: 500;
        }
        .loss {
            color: #e74c3c;
            font-weight: 600;
        }
        .badge-bm {
            background-color: #3498db;
            color: white;
            padding: 3px 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 11px;
        }
        .badge-bv {
            background-color: #1abc9c;
            color: white;
            padding: 3px 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 11px;
        }
        .summary-box {
            background-color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .summary-box h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        .summary-item {
            display: inline-block;
            margin: 10px 20px 10px 0;
        }
        .summary-item strong {
            color: #2c3e50;
        }
        .footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Análisis Completo de Métricas NPS y CSAT</h1>
        <p>Distribución 100% de Datos por Canal y Métrica</p>
        <p><strong>Período:</strong> 2025-05 a 2025-09 | <strong>Total Registros:</strong> 1,021,197 | <strong>Generado:</strong> 2025-10-17 14:50:28</p>
        <p><span class="badge-bm">BM: 1,013,592</span> <span class="badge-bv">BV: 7,605</span></p>
    </div>

    <div class="summary-box">
        <h3>📊 Resumen Ejecutivo - Distribución del 100% de los Datos</h3>
        <div class="summary-item">
            <strong>Total Registros:</strong> 1,021,197
        </div>
        <div class="summary-item">
            <strong>Con NPS:</strong> 466,265 (45.66%)
        </div>
        <div class="summary-item">
            <strong>Con CSAT:</strong> 531,636 (52.06%)
        </div>
        <br>
        <div class="summary-item">
            <strong style="color: #27ae60;">Ambas Métricas (NPS+CSAT):</strong> 0 (0.00%)
        </div>
        <div class="summary-item">
            <strong style="color: #3498db;">Solo NPS:</strong> 466,265 (45.66%)
        </div>
        <div class="summary-item">
            <strong style="color: #f39c12;">Solo CSAT:</strong> 531,636 (52.06%)
        </div>
        <div class="summary-item">
            <strong style="color: #e74c3c;">Sin Métricas:</strong> 23,296 (2.28%)
        </div>
    </div>

    <div class="section-title">📱 Métrica NPS - Banco Móvil (BM)</div>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Mes</th>
                    <th>Total Registros</th>
                    <th>Con NPS</th>
                    <th>Promedio NPS</th>
                    <th>Detractores</th>
                    <th>Neutrales</th>
                    <th>Promotores</th>
                    <th>% Detractores</th>
                    <th>% Neutrales</th>
                    <th>% Promotores</th>
                    <th>Sin NPS</th>
                    <th>% Pérdida</th>
                </tr>
            </thead>
            <tbody>

                <tr>
                    <td class="month-col">2025-09</td>
                    <td class="number">276,614</td>
                    <td class="number">127,735</td>
                    <td class="number">8.61</td>
                    <td class="number detractor">18,728</td>
                    <td class="number neutral">14,483</td>
                    <td class="number promoter">94,524</td>
                    <td class="detractor">14.66%</td>
                    <td class="neutral">11.34%</td>
                    <td class="promoter">74.00%</td>
                    <td class="number loss">148,879</td>
                    <td class="loss">53.82%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-08</td>
                    <td class="number">275,764</td>
                    <td class="number">124,243</td>
                    <td class="number">8.56</td>
                    <td class="number detractor">18,911</td>
                    <td class="number neutral">14,337</td>
                    <td class="number promoter">90,995</td>
                    <td class="detractor">15.22%</td>
                    <td class="neutral">11.54%</td>
                    <td class="promoter">73.24%</td>
                    <td class="number loss">151,521</td>
                    <td class="loss">54.95%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-07</td>
                    <td class="number">263,204</td>
                    <td class="number">117,508</td>
                    <td class="number">8.46</td>
                    <td class="number detractor">19,369</td>
                    <td class="number neutral">13,033</td>
                    <td class="number promoter">85,106</td>
                    <td class="detractor">16.48%</td>
                    <td class="neutral">11.09%</td>
                    <td class="promoter">72.43%</td>
                    <td class="number loss">145,696</td>
                    <td class="loss">55.35%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-06</td>
                    <td class="number">195,557</td>
                    <td class="number">88,072</td>
                    <td class="number">8.61</td>
                    <td class="number detractor">12,689</td>
                    <td class="number neutral">9,582</td>
                    <td class="number promoter">65,801</td>
                    <td class="detractor">14.41%</td>
                    <td class="neutral">10.88%</td>
                    <td class="promoter">74.71%</td>
                    <td class="number loss">107,485</td>
                    <td class="loss">54.96%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-05</td>
                    <td class="number">2,453</td>
                    <td class="number">1,102</td>
                    <td class="number">8.66</td>
                    <td class="number detractor">161</td>
                    <td class="number neutral">101</td>
                    <td class="number promoter">840</td>
                    <td class="detractor">14.61%</td>
                    <td class="neutral">9.17%</td>
                    <td class="promoter">76.23%</td>
                    <td class="number loss">1,351</td>
                    <td class="loss">55.08%</td>
                </tr>

                <tr class="total-row">
                    <td style="text-align: left; padding-left: 15px;">TOTAL BM</td>
                    <td class="number">1,013,592</td>
                    <td class="number">458,660</td>
                    <td class="number">8.56</td>
                    <td class="number">69,858</td>
                    <td class="number">51,536</td>
                    <td class="number">337,266</td>
                    <td>15.23%</td>
                    <td>11.24%</td>
                    <td>73.53%</td>
                    <td class="number">554,932</td>
                    <td>54.75%</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="section-title">💻 Métrica NPS - Banco Virtual (BV)</div>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Mes</th>
                    <th>Total Registros</th>
                    <th>Con NPS</th>
                    <th>Promedio NPS</th>
                    <th>Detractores</th>
                    <th>Neutrales</th>
                    <th>Promotores</th>
                    <th>% Detractores</th>
                    <th>% Neutrales</th>
                    <th>% Promotores</th>
                    <th>Sin NPS</th>
                    <th>% Pérdida</th>
                </tr>
            </thead>
            <tbody>

                <tr>
                    <td class="month-col">2025-09</td>
                    <td class="number">1,931</td>
                    <td class="number">1,931</td>
                    <td class="number">8.77</td>
                    <td class="number detractor">214</td>
                    <td class="number neutral">267</td>
                    <td class="number promoter">1,450</td>
                    <td class="detractor">11.08%</td>
                    <td class="neutral">13.83%</td>
                    <td class="promoter">75.09%</td>
                    <td class="number loss">0</td>
                    <td class="loss">0.00%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-08</td>
                    <td class="number">1,904</td>
                    <td class="number">1,904</td>
                    <td class="number">8.81</td>
                    <td class="number detractor">201</td>
                    <td class="number neutral">242</td>
                    <td class="number promoter">1,461</td>
                    <td class="detractor">10.56%</td>
                    <td class="neutral">12.71%</td>
                    <td class="promoter">76.73%</td>
                    <td class="number loss">0</td>
                    <td class="loss">0.00%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-07</td>
                    <td class="number">1,879</td>
                    <td class="number">1,879</td>
                    <td class="number">8.89</td>
                    <td class="number detractor">178</td>
                    <td class="number neutral">239</td>
                    <td class="number promoter">1,462</td>
                    <td class="detractor">9.47%</td>
                    <td class="neutral">12.72%</td>
                    <td class="promoter">77.81%</td>
                    <td class="number loss">0</td>
                    <td class="loss">0.00%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-06</td>
                    <td class="number">1,891</td>
                    <td class="number">1,891</td>
                    <td class="number">8.87</td>
                    <td class="number detractor">179</td>
                    <td class="number neutral">248</td>
                    <td class="number promoter">1,464</td>
                    <td class="detractor">9.47%</td>
                    <td class="neutral">13.11%</td>
                    <td class="promoter">77.42%</td>
                    <td class="number loss">0</td>
                    <td class="loss">0.00%</td>
                </tr>

                <tr class="total-row">
                    <td style="text-align: left; padding-left: 15px;">TOTAL BV</td>
                    <td class="number">7,605</td>
                    <td class="number">7,605</td>
                    <td class="number">8.83</td>
                    <td class="number">772</td>
                    <td class="number">996</td>
                    <td class="number">5,837</td>
                    <td>10.15%</td>
                    <td>13.10%</td>
                    <td>76.75%</td>
                    <td class="number">0</td>
                    <td>0.00%</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="section-title">⭐ Métrica CSAT - Banco Móvil (BM)</div>
    <div class="table-container">
        <p style="text-align: center; color: #7f8c8d; font-style: italic; margin-bottom: 15px;">
            ⚠️ Nota: Banco Virtual (BV) no recolecta métricas CSAT
        </p>
        <table>
            <thead>
                <tr>
                    <th>Mes</th>
                    <th>Total Registros</th>
                    <th>Con CSAT</th>
                    <th>Promedio CSAT</th>
                    <th>CSAT Mínimo</th>
                    <th>CSAT Máximo</th>
                    <th>Sin CSAT</th>
                    <th>% Pérdida</th>
                </tr>
            </thead>
            <tbody>

                <tr>
                    <td class="month-col">2025-09</td>
                    <td class="number">276,614</td>
                    <td class="number">143,140</td>
                    <td class="number">4.37</td>
                    <td class="number">-1.00</td>
                    <td class="number">5.00</td>
                    <td class="number loss">133,474</td>
                    <td class="loss">48.25%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-08</td>
                    <td class="number">275,764</td>
                    <td class="number">145,373</td>
                    <td class="number">4.33</td>
                    <td class="number">-1.00</td>
                    <td class="number">5.00</td>
                    <td class="number loss">130,391</td>
                    <td class="loss">47.28%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-07</td>
                    <td class="number">263,204</td>
                    <td class="number">139,538</td>
                    <td class="number">4.27</td>
                    <td class="number">-1.00</td>
                    <td class="number">5.00</td>
                    <td class="number loss">123,666</td>
                    <td class="loss">46.98%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-06</td>
                    <td class="number">195,557</td>
                    <td class="number">102,285</td>
                    <td class="number">4.34</td>
                    <td class="number">-1.00</td>
                    <td class="number">5.00</td>
                    <td class="number loss">93,272</td>
                    <td class="loss">47.70%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-05</td>
                    <td class="number">2,453</td>
                    <td class="number">1,300</td>
                    <td class="number">4.35</td>
                    <td class="number">-1.00</td>
                    <td class="number">5.00</td>
                    <td class="number loss">1,153</td>
                    <td class="loss">47.00%</td>
                </tr>

                <tr class="total-row">
                    <td style="text-align: left; padding-left: 15px;">TOTAL BM</td>
                    <td class="number">1,013,592</td>
                    <td class="number">531,636</td>
                    <td class="number">4.33</td>
                    <td class="number">-1.00</td>
                    <td class="number">5.00</td>
                    <td class="number">481,956</td>
                    <td>47.55%</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="section-title">📈 Distribución del 100% de los Datos - Por Canal</div>
    <div class="table-container">
        <p style="text-align: center; color: #2c3e50; font-weight: bold; margin-bottom: 15px;">
            Cómo están distribuidos el 100% de los registros según las métricas disponibles
        </p>
        <table>
            <thead>
                <tr>
                    <th>Mes</th>
                    <th>Canal</th>
                    <th>Total Registros<br>(100%)</th>
                    <th>Con Ambas Métricas<br>(NPS + CSAT)</th>
                    <th>Solo NPS</th>
                    <th>Solo CSAT</th>
                    <th>Sin Métricas</th>
                    <th>% Ambas</th>
                    <th>% Solo NPS</th>
                    <th>% Solo CSAT</th>
                    <th>% Sin Métricas</th>
                </tr>
            </thead>
            <tbody>

                <tr>
                    <td class="month-col">2025-05</td>
                    <td><span class="badge-bm">BM</span></td>
                    <td class="number" style="font-weight: bold;">2,453</td>
                    <td class="number promoter">0</td>
                    <td class="number" style="color: #3498db; font-weight: 500;">1,102</td>
                    <td class="number" style="color: #f39c12; font-weight: 500;">1,300</td>
                    <td class="number loss">51</td>
                    <td class="promoter">0.00%</td>
                    <td style="color: #3498db; font-weight: 500;">44.92%</td>
                    <td style="color: #f39c12; font-weight: 500;">53.00%</td>
                    <td class="loss">2.08%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-06</td>
                    <td><span class="badge-bm">BM</span></td>
                    <td class="number" style="font-weight: bold;">195,557</td>
                    <td class="number promoter">0</td>
                    <td class="number" style="color: #3498db; font-weight: 500;">88,072</td>
                    <td class="number" style="color: #f39c12; font-weight: 500;">102,285</td>
                    <td class="number loss">5,200</td>
                    <td class="promoter">0.00%</td>
                    <td style="color: #3498db; font-weight: 500;">45.04%</td>
                    <td style="color: #f39c12; font-weight: 500;">52.30%</td>
                    <td class="loss">2.66%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-06</td>
                    <td><span class="badge-bv">BV</span></td>
                    <td class="number" style="font-weight: bold;">1,891</td>
                    <td class="number promoter">0</td>
                    <td class="number" style="color: #3498db; font-weight: 500;">1,891</td>
                    <td class="number" style="color: #f39c12; font-weight: 500;">0</td>
                    <td class="number loss">0</td>
                    <td class="promoter">0.00%</td>
                    <td style="color: #3498db; font-weight: 500;">100.00%</td>
                    <td style="color: #f39c12; font-weight: 500;">0.00%</td>
                    <td class="loss">0.00%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-07</td>
                    <td><span class="badge-bm">BM</span></td>
                    <td class="number" style="font-weight: bold;">263,204</td>
                    <td class="number promoter">0</td>
                    <td class="number" style="color: #3498db; font-weight: 500;">117,508</td>
                    <td class="number" style="color: #f39c12; font-weight: 500;">139,538</td>
                    <td class="number loss">6,158</td>
                    <td class="promoter">0.00%</td>
                    <td style="color: #3498db; font-weight: 500;">44.65%</td>
                    <td style="color: #f39c12; font-weight: 500;">53.02%</td>
                    <td class="loss">2.34%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-07</td>
                    <td><span class="badge-bv">BV</span></td>
                    <td class="number" style="font-weight: bold;">1,879</td>
                    <td class="number promoter">0</td>
                    <td class="number" style="color: #3498db; font-weight: 500;">1,879</td>
                    <td class="number" style="color: #f39c12; font-weight: 500;">0</td>
                    <td class="number loss">0</td>
                    <td class="promoter">0.00%</td>
                    <td style="color: #3498db; font-weight: 500;">100.00%</td>
                    <td style="color: #f39c12; font-weight: 500;">0.00%</td>
                    <td class="loss">0.00%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-08</td>
                    <td><span class="badge-bm">BM</span></td>
                    <td class="number" style="font-weight: bold;">275,764</td>
                    <td class="number promoter">0</td>
                    <td class="number" style="color: #3498db; font-weight: 500;">124,243</td>
                    <td class="number" style="color: #f39c12; font-weight: 500;">145,373</td>
                    <td class="number loss">6,148</td>
                    <td class="promoter">0.00%</td>
                    <td style="color: #3498db; font-weight: 500;">45.05%</td>
                    <td style="color: #f39c12; font-weight: 500;">52.72%</td>
                    <td class="loss">2.23%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-08</td>
                    <td><span class="badge-bv">BV</span></td>
                    <td class="number" style="font-weight: bold;">1,904</td>
                    <td class="number promoter">0</td>
                    <td class="number" style="color: #3498db; font-weight: 500;">1,904</td>
                    <td class="number" style="color: #f39c12; font-weight: 500;">0</td>
                    <td class="number loss">0</td>
                    <td class="promoter">0.00%</td>
                    <td style="color: #3498db; font-weight: 500;">100.00%</td>
                    <td style="color: #f39c12; font-weight: 500;">0.00%</td>
                    <td class="loss">0.00%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-09</td>
                    <td><span class="badge-bm">BM</span></td>
                    <td class="number" style="font-weight: bold;">276,614</td>
                    <td class="number promoter">0</td>
                    <td class="number" style="color: #3498db; font-weight: 500;">127,735</td>
                    <td class="number" style="color: #f39c12; font-weight: 500;">143,140</td>
                    <td class="number loss">5,739</td>
                    <td class="promoter">0.00%</td>
                    <td style="color: #3498db; font-weight: 500;">46.18%</td>
                    <td style="color: #f39c12; font-weight: 500;">51.75%</td>
                    <td class="loss">2.07%</td>
                </tr>

                <tr>
                    <td class="month-col">2025-09</td>
                    <td><span class="badge-bv">BV</span></td>
                    <td class="number" style="font-weight: bold;">1,931</td>
                    <td class="number promoter">0</td>
                    <td class="number" style="color: #3498db; font-weight: 500;">1,931</td>
                    <td class="number" style="color: #f39c12; font-weight: 500;">0</td>
                    <td class="number loss">0</td>
                    <td class="promoter">0.00%</td>
                    <td style="color: #3498db; font-weight: 500;">100.00%</td>
                    <td style="color: #f39c12; font-weight: 500;">0.00%</td>
                    <td class="loss">0.00%</td>
                </tr>

                <tr class="total-row">
                    <td colspan="2" style="text-align: left; padding-left: 15px;">TOTAL CONSOLIDADO (BM+BV)</td>
                    <td class="number">1,021,197</td>
                    <td class="number">0</td>
                    <td class="number">466,265</td>
                    <td class="number">531,636</td>
                    <td class="number">23,296</td>
                    <td>0.00%</td>
                    <td>45.66%</td>
                    <td>52.06%</td>
                    <td>2.28%</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="footer">
        <p><strong>✅ Verificación de Integridad:</strong> Ambas + Solo NPS + Solo CSAT + Sin Métricas = 100% de los registros</p>
        <p><strong>Fórmula:</strong> 0 + 466,265 + 531,636 + 23,296 = 1,021,197 registros</p>
        <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
        <p>Tabla generada por 4_visualizacion.py | Base de datos: nps_analitycs</p>
        <p>Fuentes: banco_movil_clean (BM) y banco_virtual_clean (BV)</p>
    </div>
</body>
</html>
